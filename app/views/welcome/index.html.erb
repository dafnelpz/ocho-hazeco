<!DOCTYPE html>
<html>
<head>
  <title>Ocho</title>
  <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' => true %>
  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
  <%= csrf_meta_tags %>
</head>
<body>
	<!-- LOGIN WITH FB -->
	<script>
	  window.fbAsyncInit = function() {
	    FB.init({
	      appId      : '865923363537795',
	      xfbml      : true,
	      version    : 'v2.6'
	    });
	  };

	  (function(d, s, id){
	     var js, fjs = d.getElementsByTagName(s)[0];
	     if (d.getElementById(id)) {return;}
	     js = d.createElement(s); js.id = id;
	     js.src = "//connect.facebook.net/en_US/sdk.js";
	     fjs.parentNode.insertBefore(js, fjs);
	   }(document, 'script', 'facebook-jssdk'));
	</script>

	<%= yield %>
	<%= render "partials/navbar" %>
	
	<!-- SLIDER -->
	<div id="contentContainer">
		<div id="wrapper">
		    <div id="itemOne" class="content"></div>
		    <div id="itemTwo" class="content"></div>
		    <div id="itemThree" class="content"></div>
		    <div id="itemFour" class="content"></div>
		</div>

		<div id="navLinks">
		    <ul>
		        <li class="itemLinks" data-pos="0vw"></li>
		        <li class="itemLinks" data-pos="-100vw"></li>
		        <li class="itemLinks" data-pos="-200vw"></li>
		        <li class="itemLinks" data-pos="-300vw"></li>
		    </ul>
		</div>
	</div>
	
	<!-- JAVASCRIPT SLIDER -->
	<script>
		var links = document.querySelectorAll(".itemLinks");
		var wrapper = document.querySelector("#wrapper"); 
		// the activeLink provides a pointer to the currently displayed item
		var activeLink = 0;
		 
		// setup the event listeners
		for (var i = 0; i < links.length; i++) {
		    var link = links[i];
		    link.addEventListener('click', setClickedItem, false);
		 
		    // identify the item for the activeLink
		    link.itemID = i;
		}
		 
		// set first item as active
		links[activeLink].classList.add("active");
		 
		function setClickedItem(e) {
		    removeActiveLinks();
		 
		    var clickedLink = e.target;
		    activeLink = clickedLink.itemID;
		 
		    changePosition(clickedLink);
		}
		 
		function removeActiveLinks() {
		    for (var i = 0; i < links.length; i++) {
		        links[i].classList.remove("active");
		    }
		}
		 
		// Handle changing the slider position as well as ensure
		// the correct link is highlighted as being active
		function changePosition(link) {
		    var position = link.getAttribute("data-pos");
		 
		    var translateValue = "translate3d(" + position + ", 0px, 0)";
		    wrapper.style[transformProperty] = translateValue;
		 
		    link.classList.add("active");
		}

		// Dealing with Transforms
		var transforms = ["transform",
		            "msTransform",
		            "webkitTransform",
		            "mozTransform",
		            "oTransform"];
		 
		var transformProperty = getSupportedPropertyName(transforms);
		 
		// vendor prefix management
		function getSupportedPropertyName(properties) {
		    for (var i = 0; i < properties.length; i++) {
		        if (typeof document.body.style[properties[i]] != "undefined") {
		            return properties[i];
		        }
		    }
		    return null;
		}

		// The code for sliding the content automatically
		var timeoutID;
		 
		function startTimer() {
		    // wait 2 seconds before calling goInactive
		    timeoutID = window.setInterval(goToNextItem, 3000);
		}
		startTimer();
		 
		function resetTimer() {
		    window.clearInterval(timeoutID);
		    startTimer();
		}
		 
		function goToNextItem() {
		    removeActiveLinks();
		 
		    if (activeLink < links.length - 1) {
		        activeLink++;
		    } else {
		        activeLink = 0;
		    }
		 
		    var newLink = links[activeLink];
		    changePosition(newLink);
		}

		function setClickedItem(e) {
	    removeActiveLinks();
	    resetTimer();
	 
	    var clickedLink = e.target;
	    activeLink = clickedLink.itemID;
	 
	    changePosition(clickedLink);
		}
	</script>
</body>
</html>
